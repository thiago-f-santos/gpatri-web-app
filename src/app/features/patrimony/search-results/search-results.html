<div class="search-container">
    <app-search-input 
    [(ngModel)]="searchQuery"
    (search)="onSearch($event)">
    </app-search-input>

    @if (requestItems$ | async; as items) {
    <div class="request-section">
        
        <h2 class="request-title">Sua solicitação</h2>
        @if (items.length === 0) {
            <p class="request-subtitle">Sua solicitação ainda está vazia...</p>
        } @else {
            <div class="request-items-list">
            @for (item of items; track item.id) {
            <app-item-display
                [mainText]="item.id"
                [secondaryText]="item.condition"
                [showDeleteButton]="true" 
                [isSelectable]="false"
                (delete)="removeItemFromRequest(item)">>
            </app-item-display>
            }
            </div>
            
            <app-button
                text="Confirmar"
                (onClick)="confirmRequest()">
            </app-button>
        }
        
    </div>

    <div class="found-items-section">
        <h2 class="found-items-title">Itens encontrados para '{{ searchQuery }}'</h2>
        
        @if (patrimonies$ | async; as patrimonies) {
        @if(patrimonies.length > 0) {
            @for (patrimony of patrimonies; track patrimony.id) {
            <app-patrimony-display
                [patrimonyName]="patrimony.patrimonyName"
                [categoryName]="patrimony.categoryName"
                [items]="patrimony.items"
                [selectedItems]="(requestItems$ | async) || []"
                (itemSelected)="selectItem($event)"
            ></app-patrimony-display>
            }
        } @else {
            <p class="request-subtitle">Nenhum item encontrado.</p>
        }
        } @else {
        <p class="request-subtitle">Buscando itens...</p>
        }
    </div>
    } @else {
        <p class="request-subtitle">Carregando sua solicitação...</p>
    }
</div>